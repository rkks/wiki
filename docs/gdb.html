<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Ravikiran K.S." />
  <title>GDB CheatSheet | Ravikiran K.S</title>
  <link rel="stylesheet" href="./css/bootstrap.css" type="text/css" />
  <link rel="stylesheet" href="./css/colortheme.css" type="text/css" />
  <link rel="stylesheet" href="./css/extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/web.css" type="text/css" />
</head>



<body>

<div class="container">
<div class="row">
<div class="span2">&nbsp;</div>
<div class="span7">

<!-- Begin _navigation.html. This is inserted using the include-before-body option in pandoc -->
<nav class="navbar navbar-default">
<div class="header">
        <ul class= "nav nav-pills pull-right">
            <li class="hidden-phone"><a href="./software.html">Software/</a></li>
            <li class="hidden-phone"><a href="./hacks.html">Hacks/</a></li>
            <li class="hidden-phone"><a href="./ideas.html">Ideas/</a></li>
            <li class="hidden-phone"><a href="./reviews.html">Reviews/</a></li>
            <li class="hidden-phone"><a href="./thoughts.html">Thoughts/</a></li>
            <li><a href="index.html"><img src="./img/author.jpg" class="pull-left"></a></li>
        </ul>
</div>
</nav>
<!-- End _navigation.html -->

<article>

<!-- bs-docs-section custom var "category" is set by mkweb.sh and used in pandoc template -->
<div id="category" class="row">
<ol class="breadcrumb">
<li><a href="./index.html">Home /</a></li>
<li><a href="./Hacks.html"> Hacks /</a></li>
</ol>
</div>
<!--The title is produced by the pandoc template using the title block at the top of the markdown file-->
<h1>GDB CheatSheet</h1>
<!--The author is produced by the pandoc template using the title block at the top of the markdown file-->
<div id="dateline">
Posted by Ravikiran K.S.
<!--The date is produced by the pandoc template using the title block at the top of the markdown file-->
on Jan 1, 2006</div>

<!--Begin content of the main markdown file for this page, which is processed by pandoc and output as html.-->

<h3 id="gdb-tips">GDB Tips</h3>
<p>1. Redraw screen: <code>[Ctrl-L]</code></p>
<p>2. Open TUI interface: <code>[Ctrl-x a]</code></p>
<h3 id="gdb-commands">GDB Commands</h3>
<p>1. Dump some area of memory for observation:</p>
<pre class="code"><code>dump binary memory dump.raw 0x4005f8 0x400633</code></pre>
<p>2. display expression each time program stops</p>
<pre class="code"><code>display &lt;expr&gt;</code></pre>
<p>3. Pass control from C program to GDB.</p>
<pre class="code"><code>asm(&quot;int $0x3\n&quot;);</code></pre>
<p>This instruction in code will pass control from running program to gdb; so that program state could be analyzed at that point. To catch this interrupt, the process should be running under debugger. This is useful in conjunction with ‘ld –wrap’ option. With ‘ld –wrap’ option, you can write a wrapper api which should be called when wrapped function is to be invoked. In this wrapper api, you could check for input values and see how they appear to be library function.</p>
<p>6. Display list of frames (same as bt) and move through frames</p>
<pre class="code"><code>info frame
up, down, frame</code></pre>
<p>7. Break once, and then remove the breakpoint</p>
<pre class="code"><code>tbreak</code></pre>
<p>8. Gives complete backtrace with local variables</p>
<pre class="code"><code>bt full</code></pre>
<p>9. Give backtrace of all threads running</p>
<pre class="code"><code>thread apply all bt</code></pre>
<p>10. Print PC (program counter) register of all threads running</p>
<pre class="code"><code>thread apply all print $pc</code></pre>
<p>11. Continue till end of function</p>
<pre class="code"><code>finish</code></pre>
<p>12. Suspend the process when a certain condition is met</p>
<pre class="code"><code>watch</code></pre>
<p>13. break on function matching regular expression</p>
<pre class="code"><code>rbreak</code></pre>
<p>14. Creating coredump of a running process</p>
<pre class="code"><code>(gdb) attach &lt;pid&gt;
(gdb) generate-core-file &lt;file-name&gt;
(gdb) detach</code></pre>
<p>OR</p>
<pre class="code"><code>$ kill -s SIGABRT &lt;pid&gt;</code></pre>
<p>Note: the SIGABRT will terminate the process and generate corefile. Also, for it to work, the signal shouldn’t be caught by a custom signal handler.</p>
<p>To obtain a good call stack, it is important that gdb loads the same libraries that were loaded by the program that generated the core dump. If the analyzing machine is different than the one where core happened, then copy the libraries over to analyzing machine in a way that mirrors dump machine. Ex.</p>
<pre class="code"><code>$ tree .
.
-\ juggler-29964.core
-\ lib64
  |-\ ld-linux-x86-64.so.2
  |-\ libc.so.6
  |-\ libm.so.6
  |-\ libpthread.so.0
  |-\ librt.so.1</code></pre>
<p>…</p>
<pre class="code"><code>(gdb) set solib-absolute-prefix ./
(gdb) set solib-search-path .
(gdb) file ../../../../../threadpool/bin.v2/libs/threadpool/example/juggler/gcc-4.1.2/debug/link-static/threading-multi/juggler
(gdb) core-file juggler-29964.core</code></pre>
<p>15. Find zombie threads. Any thread that has terminated but has not been joined or detached will leak OS resources until the process terminates. Unfortunately, neither /proc nor gdb will show you these zombie threads, at least not on some kernels. One way to get them is with a gdb canned command:</p>
<pre class="code"><code>define trace_call
  b $arg0
  commands
    bt full
    continue
  end
end</code></pre>
<pre class="code"><code>document trace_call
Trace specified call with call stack to screen. Example:
  set breakpoint pending on
  set pagination off
  set logging on
  trace_call __pthread_create_2_1
end</code></pre>
<p>TUI Key Bindings</p>
<p>TUI installs several key bindings in readline keymaps (Command Line Editing).</p>
<ul>
<li><p>`C-x C-a’/`C-x a’/`C-x A’ - Enter or leave the TUI mode.</p></li>
<li><p>`C-x 1’ - Use a TUI layout with only one window.</p></li>
<li><p>`C-x 2’ - Use a TUI layout with at least two windows.</p></li>
<li><p>`C-x o’ - Change the active window. Gives the focus to the next TUI window.</p></li>
<li><p>`C-x s’ - Use TUI _SingleKey_ keymap that binds single key to gdb commands (TUI Single Key Mode).</p></li>
<li><p>&lt;PgUp&gt; - Scroll the active window one page up.</p></li>
<li><p>&lt;PgDn&gt; - Scroll the active window one page down.</p></li>
<li><p>&lt;Up&gt; - Scroll the active window one line up.</p></li>
<li><p>&lt;Down&gt; - Scroll the active window one line down.</p></li>
<li><p>&lt;Left&gt; - Scroll the active window one column left.</p></li>
<li><p>&lt;Right&gt; - Scroll the active window one column right.</p></li>
<li><p>&lt;C-L&gt; - Refresh the screen.</p></li>
</ul>
<p>In TUI mode, arrow keys are used by the active window for scrolling. This means they are available for readline when the active window is the command window. When command window does not have focus, it is necessary to use other readline key bindings such as: &lt;C-p&gt;, &lt;C-n&gt;, &lt;C-b&gt; and &lt;C-f&gt;.</p>

<!--End content from the main markdown file for this page.-->

</article>

<!-- Begin footer.html. This is inserted using the include-after-body option in pandoc -->

<footer id="footer">
    <ul class="nav nav-pills pull-right hidden-phone">
        <!-- Email obfuscator by Tim Williams requires javascript (http://www.jottings.com/obfuscator/) -->
        <!-- Below one does not need javascript. Generated at: http://robspangler.com/blog/encrypt-mailto-links-to-stop-email-spam/ -->
        <li class="transparent"><a href="&#109;&#x61;&#105;&#108;&#x74;&#x6f;&#58;&#x66;&#x72;&#105;&#101;&#x6e;&#x64;&#x73;&#52;&#x77;&#101;&#x62;&#64;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#109;" title="My Email"><img src="./img/glyph_email.png"></a></li>
        <li class="transparent"><a href="https://www.linkedin.com/in/ravikiranks" title="LinkedIn"><img src="./img/glyph_linkedin.png"></a></li>
        <li class="transparent"><a href="http://trivialconversations.wordpress.com" title="My Blog"><img src="./img/glyph_wordpress.png"></a></li>
        <li class="transparent"><a href="http://github.com/rkks" title="Github repo"><img src="./img/glyph_github.png"></a></li>
        <li class="transparent"><a type="application/rss+xml" href="./feed.xml" title="RSS Feeds"><img src="./img/glyph_rss.png"></a></li>
    </ul>

    <ul class="unstyled">
        <li><a rel="license" href="https://choosealicense.com/no-license/"><copyleft>&copy;</copyleft> All wrongs reserved</a></li>
    </ul>
</footer>

<!-- StatCounter Code from Default Guide -->

<script type="text/javascript">
    var sc_project=11365917;
    var sc_invisible=1;
    var sc_security="58ddb939";
    var scJsHost = (("https:" == document.location.protocol) ? "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +scJsHost+"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter">
<a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="//c.statcounter.com/11365917/0/58ddb939/1/" alt="web analytics"></a>
</div></noscript>

<!-- End of footer.html -->

</div>

<div class="span3">&nbsp;</div>

</div>
</div>
</body>
</html>
